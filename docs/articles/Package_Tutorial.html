<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Package Tutorial • PPS.Analysis</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Package Tutorial">
<meta property="og:description" content="PPS.Analysis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PPS.Analysis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Package_Tutorial.html">Package Tutorial</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Package Tutorial</h1>
                        <h4 data-toc-skip class="author">Basanta
Khakurel</h4>
            
            <h4 data-toc-skip class="date">2022-11-29</h4>
      
      
      <div class="hidden name"><code>Package_Tutorial.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="tutorial-to-use-functions-from-pps-analysis-">Tutorial to use functions from PPS.Analysis.<a class="anchor" aria-label="anchor" href="#tutorial-to-use-functions-from-pps-analysis-"></a>
</h2>
<p>You might have already seen the introduction section of the website.
It gives you a hint on what the data looks like. So let’s get started by
downloading the simulated data set and the empirical data set. These
data contain the summary statistics of the simulated and empirical data
generated by a Bayesian phylogenetic software called
<code>RevBayes</code>.</p>
<p>The data to this tutorial can be found here.</p>
<p><a href="https://raw.githubusercontent.com/basanta33/PPS.Analysis/main/data/simulated_data_pps_data.csv" class="external-link">Simulated
Data</a></p>
<p><a href="https://raw.githubusercontent.com/basanta33/PPS.Analysis/main/data/empirical_data_pps_data.csv" class="external-link">Empirical
Data</a></p>
<p>Download these files and put it in a folder called ‘data’.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/basanta33/PPS.Analysis/main/data/simulated_data_pps_data.csv"</span>, destfile <span class="op">=</span> <span class="st">"data/simulated_data_pps_data.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/basanta33/PPS.Analysis/main/data/simulated_data_pps_data.csv"</span>, destfile <span class="op">=</span> <span class="st">"data/simulated_data_pps_data.csv"</span><span class="op">)</span></span></code></pre></div>
<p>As the package depends on some other R packages, we need to load it
into the library first.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor" class="external-link">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">PPS.Analysis</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="function-1-renaming-the-columns">Function 1: Renaming the Columns<a class="anchor" aria-label="anchor" href="#function-1-renaming-the-columns"></a>
</h4>
<p>If we open the csv files containing the data I generated, first we
notice that the names of columns are really well-written which makes it
uneasy to work with codes, so the first thing we’ll be doing is renaming
the columns of the csv files.</p>
<p>My first function reads the data and changes the names of columns to
a more code-friendly one.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rename_col.html">rename_col</a></span><span class="op">(</span><span class="st">"../data/simulated_data_pps_data.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">empdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rename_col.html">rename_col</a></span><span class="op">(</span><span class="st">"../data/empirical_data_pps_data.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s take a look at the data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">simdata</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">empdata</span><span class="op">)</span></span></code></pre></div>
<p>In addition to cleaning the names for the data read in the
environment, it also saves the column-changed data to a csv file.</p>
<hr>
</div>
<div class="section level4">
<h4 id="function-2-removing-unnecessary-columns">Function 2: Removing Unnecessary Columns<a class="anchor" aria-label="anchor" href="#function-2-removing-unnecessary-columns"></a>
</h4>
<p>As we take a look at the cleaned data file, we see that it contains a
lot of columns, most of which having all the values 0. The data was
generated using morphological character sets so we would not have
certain summary statistics like GC content (which is one of the valuable
summary statistics for molecular sequence). So, the second function I
have will get rid of the columns that we do not need.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_blank.html">remove_blank</a></span><span class="op">(</span><span class="va">simdata</span><span class="op">)</span></span>
<span></span>
<span><span class="va">empdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_blank.html">remove_blank</a></span><span class="op">(</span><span class="va">empdata</span><span class="op">)</span></span></code></pre></div>
<p>Now if we View the data sets, we can see that the unnecessary columns
have been removed and it also saves another csv file with the reduced
data set.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">simdata</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">empdata</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level4">
<h4 id="function-3-linear-model-between-two-columns-of-the-data-set">Function 3: Linear Model between two columns of the data set<a class="anchor" aria-label="anchor" href="#function-3-linear-model-between-two-columns-of-the-data-set"></a>
</h4>
<p>For the third function I have here, it looks at the linear
relationship of any two columns that you desire. For this we’d be
looking at the simulated summary stats data and we can compare any of
the columns from the data. This way we can view how related are the two
columns linearly in our distribution of the data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/linear_model.html">linear_model</a></span><span class="op">(</span><span class="va">simdata</span>, <span class="va">simdata</span><span class="op">$</span><span class="va">tajima_d</span>, <span class="va">simdata</span><span class="op">$</span><span class="va">tajima_pi</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level4">
<h4 id="function-4-effect-size-calculation">Function 4: Effect Size Calculation<a class="anchor" aria-label="anchor" href="#function-4-effect-size-calculation"></a>
</h4>
<p>This is a measure of sample-based estimate for the variable. It can
show a meaningful relationship between the empirical and simulated
columns. It can manually be calculated using the following equation:</p>
<p><span class="math inline">\(d = \frac{x_1 - x_2}{s}\)</span></p>
<p>This is also known as Cohen’s d formula. It is designed to compare
two groups. It takes the difference between two means and expresses it
in standard deviation units. It tells you how many standard deviations
lie between the two means.</p>
<p>As a general rule of thumb, effect size can be interpreted as
following:</p>
<ul>
<li><p>Small Effect = 0.2</p></li>
<li><p>Medium Effect = 0.5</p></li>
<li><p>Large Effect = 0.8</p></li>
</ul>
<p>In our case, we use the median of the simulated column and as the
empirical column has only one value, we use that to calculate the effect
size. The column of empirical data and simulated data should be the same
to obtain the ‘accurate’ effect size.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/effect_size.html">effect_size</a></span><span class="op">(</span><span class="va">simdata</span><span class="op">$</span><span class="va">tajima_pi</span>, <span class="va">empdata</span><span class="op">$</span><span class="va">tajima_pi</span><span class="op">)</span>  </span></code></pre></div>
<p>This is the effect size for the column Tajima’s Pi. The value we
obtain here is greater than 0.8, so we can conclude that the effect size
is large. ***</p>
</div>
<div class="section level4">
<h4 id="function-5-plotting">Function 5: Plotting<a class="anchor" aria-label="anchor" href="#function-5-plotting"></a>
</h4>
<p>The final function in my package is to visualize the distribution of
the columns, for this we can create a density plot of the columns with a
line of the empirical value. This will give us how aligned out simulated
data values are with the empirical data value.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/den_plot.html">den_plot</a></span><span class="op">(</span><span class="va">simdata</span>, <span class="va">empdata</span><span class="op">$</span><span class="va">max_pairwise_difference_excluding_ambiguous</span>, <span class="va">simdata</span><span class="op">$</span><span class="va">max_pairwise_difference_excluding_ambiguous</span>, <span class="st">"Maximum Pairwise Difference Excluding Ambiguous"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span></span></code></pre></div>
<p>As we view the plot, we can see that the empirical data aligns where
the simulated data is mostly distributed. So this means that our
simulated data is close to the empirical data looking at this summary
statistics.</p>
<p>The plot should be looking something like this: <img src="Rplot.png"></p>
<div class="section level6">
<h6 id="thank-you-for-following-this-tutorial">Thank you for following this tutorial!!<a class="anchor" aria-label="anchor" href="#thank-you-for-following-this-tutorial"></a>
</h6>
<hr>
<hr>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Basanta Khakurel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
